# **Introduction blockchain Ethereum**

## **DLT: Distributed ledger technology AKA Blockchain**

Blockchain technologies solved 2 problems:

- immutability: data can't be altered
- distributed process: no more a single point of authority, each nodes work together based on a consensus mechanism preventing malicious actors.

### **Immutability**

In a blockchain all transactions are stored in a block.
Each block includes the `cryptographic hash` of the prior block in the chain, linking the two blocks, and also a `cryptographic hash` of all the transactions stored in the block.  
The `cryptographic hash`, is a `hash` generated by a `cryptographic hash function`.  
The `cryptographic hash function` is a one way function (non invertible function) that maps the content of a block to a number.  
These 2 numbers, the `cryptographic hash` of the previous block and the `cryptographic hash` of all the confirmed transactions in the block, are stored in the `block header` of the new incoming block.  
![blockchain](../res/blockchain.jpeg)
Bellow how this kind of process can be implemented with code:
![code structure of blockchain](../res/codeview.jpg)  
This process confirms the **integrity** of the block, all the way back to the original `genesis block`.

If a malicious actor want to alter a block, for example by changing a transaction amount, he will alter the `hash` of all the transactions within the block. So he will have to mine again this block. The process will alter the whole block `hash`, and all the following blocks will have a different `hash` stored in their header for the previous block. So the malicious actor will have to mine also all the following blocks based on the `hash` of the malicious crafted block.  
The other protection which prevent these kind of modifications is a consensus mechanism.
Attackers would need to control 51% of the network to reverse transactions that have already taken place in a blockchain.
This is known as the **51% Attack**
Needless to say that this is actually impossible, attackers would need to much computational power, and even if they succeed it would invalidate trust on this blockchain and users will just leave.

### **Centralized vs Decentralized vs Distributed**

![Centralized vs Decentralized vs Distributed](../res/CDD.png)

In a Distributed network there is not a single (or even multi) point of authority, named `POA`.  
The objective is to avoid a single point of failure: `SPOF`
So consensus mechanisms are used to make sure that each nodes in a distributed network work together, and never in a malicious way.  
In the case of a blockchain network, consensus mechanisms are used to control how a blockchain transaction can be validated, written in a block and executed.

### **Consensus mechanisms**

#### **Byzantine generals problem**

https://fr.wikipedia.org/wiki/Probl%C3%A8me_des_g%C3%A9n%C3%A9raux_byzantins

#### **Proof of work: PoW**

In french: **preuve de travail**.  
This is the original consensus algorithm.  
With `PoW`, miners compete against each other to complete transactions on the network and add new blocks to the blockchain.  
Miners have to solve a difficult puzzle using their computers processing power.  
The mathematical puzzle to solve consists in finding a hash number by manipulating the `nonce`. The hash number to find has to be less than a `target` hash. The `target` hash is defined by a `difficulty`.  
The first miner to solve the puzzle is given a reward for their work.  
A proof of work is a piece of data which is difficult (costly, time-consuming) to produce but easy for others to verify and which satisfies certain requirements.

#### **Proof of stake: PoS**

In french: **preuve d'enjeu** ou **preuve de participation**.

### **Mining**

The Miner nodes in Ethereum are the nodes that create blocks in the chain. A block is a data structure that contains a set of transactions. When creating a block, the miner will select some transactions from its pool of pending transactions (transactions waiting to be included in the chain) and start mining the block.
The important thing to know is that mining is an expensive process. Therefore, if Miners didn’t get anything in return for mining, no one would do it.
In Ethereum, when a miner mines a new block, it receives the fees from all transactions included in this block and a block reward (actually 2 ETH). Therefore, the higher the gasPrice in the transactions, the higher the fees that the miner receives will be.
So a miner validate a block of transaction, by doing this he will earn a block reward and all the transaction fees of each transaction within the block.

### **Gas**

https://pegasys.tech/ethereum-explained-gas-payment-and-mining/
Protection system + reward for validator
gasPrice:The gasPrice is the value that the transaction sender is willing to pay per gas unit.  
gasLimit: Sometimes when executing a transaction, you might not know exactly how much it is going to cost. Imagine a scenario where you have a smart contract with a bug, an infinity loop. Without a gasLimit, it would be possible to consume the whole balance of the sender account. The gasLimit is a safety mechanism to prevent someone from using all their Ether due to a bug or an estimation error.
When sending a transaction, it can be hard to know what is the minimum gasPrice at that moment. There are some tools that scan the network and the average gasPrice used in recent transactions to help with choosing a fair gasPrice that is likely to be accepted by miners.  
https://ethgasstation.info/ (install browser extension too)

### **asymetric crytography**

ECDSA formula
ECDSA curve
Private key
Public key

## **Ethereum**

### **Ethereum vs Bitcoin**

ETH vs BTC

The main difference between Ethereum and Bitcoin

### **Smart contracts**

## **Metamask**

### **Installation**

### **Configuration**

### **Networks**

### **Faucets**

### **web3**

## **Transaction**

Depuis metamask + blockchain explorer
2 types of transaction signed and unsigned.

Unsigned transaction are free, used for reading states on the Ethereum blockchain

- Check ETH amount own an ETH address
- Read a state/value from a smart contracts

Signed transaction are mandatory for changing state on the Ethereum blockchain. Sender of the transaction have to prove that he

- Sending ETH
- Deploy a smart contracts
- Change the state of a smart contracts.

## **Remix**

On voit les réseau

## **Ganache**

Ganache is a local development Ethereum node, for fast deployment and testing. In a professional Environment `remix`is not an option.

### **Switch back to node 12**

ganache-cli doesn't work on nodejs 14 yet. So we need to switch back to nodejs 12.

### **Installation**

Install with `yarn`:

```zsh
% yarn global ganache-cli
```

To have access to Yarn’s executables globally, you will need to set up the PATH environment variable in your terminal. To do this, add the line below into your profile, in my case my profile is in `~/.zprofile`:

````zsh
export PATH="\$PATH:`yarn global bin`"
```

and then load your profile, in my case `~/.zprofile`:
```zsh
% source ~/.zprofile
````

### **Execution**

## **Deploy a Smart contract from Remix**

### **First smart contract on browser**

### **First smart contract on ganache**

### **First smart contract on a testnet**

## Glossary:

`BTC`: Bitcoin cryptocurrency  
`DAO`: Decentralized Autonomous Organization
`cryptographic hash`: see `hash`
`cryptographic hash function`: see `hasing function`  
`Difficulty`: This describes how difficult, in relation to the genesis block, the target will be to reach.
`ECDSA`: Elliptic Curve Digital Signature Algorithm  
`ETH`: Ethereum/Ether cryptocurrency
`EVM`: Ethereum Virtual Machine  
`Gas`:
`Genesis block`: The first block of a blockchain
`hash`: A unique identifier of a data.  
`hashing function`: take an input, file or data, and generate a `hash` of this input  
`POA`: Point Of Authority
`PoW`: Proof of Work
`PoS`: Proof of Stake  
`SPOF`: Single Point Of Failure
`Target`: The number that the block hash must be less than in order to be valid
